# 本次修改说明

  基于`cosine`的假设，计算特征向量的最佳方式应该是把其放在一个单位球上，用角度来度量他们之间的差异情况。这让我想到*`softmax`*函数的变版`ArcFace`[<sup>1</sup>](#refer-anchor1)和`CosFace`[<sup>2</sup>](#refer-anchor2)。可以中获得进一步改进的思路和方法。

  在本次实验中，先暂时实现把向量都放在一个单位球上，通过计算他们的角度差异来度量权重的大小。

  经过代码验证，已经说明了现将特征向量放在球上作余弦相似度和直接做余弦相似度处理，两者实际上是一致的。所以，设想的修改并没有什么意义。

# 实际作的修改

  因为，我们一直讨论的都是在权重的总和为1的前提下做的。但是，之前一个比较的结果是在定义随意参数得到的。这个参数可能并不满足，权重的总和为一的条件。

  所以，如果我们想讨论是否做的改进比平均池化好。应该做的是，先用平均池化得到一个基础的`Baseline`再一步步做比较，才是符合逻辑的。

  本次实验做的修改是，把之前的权重导向改进，退回到平均池化。

# 实验结果

|epoch|mAP|rank1|rank5|
|:--:|:--:|:--:|:--:|
|520|79.1%|84.8%|94.9%|
|480|78.9%|84.6%|94.7%|
|440|79.0%|84.6%|94.8%|
|400|78.7%|84.6%|94.9%|

# 实验分析

直接使用`平均池化`的效果比使用`改进池化`的效果好的还挺多的。说明，可能这种方法没有你想象的那么`work`。具体原因，实际我们也分析过，使用`余弦相似度`度量中心距离和直接使用$\frac{1}{N}$相差的不是很多。但是，用`欧式距离`数值太大不适合于$Softmax$函数混用。想在这里找到合适的用法，还是需要花上一些心思的。


## 参考文献

<div id="refere-anchor-1"></div>
-[1] Arcface: Additive angular margin loss for deep face recognition
<div id="refere-anchor-2"></div>
-[2] Cosface:Large margin cosine loss for deep face recognition